# 機械学習の基礎
## 機械学習とは
過去の観測値データから結果や値を予測することができる。  
- 気象と売り上げの予測
- 身体データからの将来の罹患予測
- 観測データから種の特定をする　など

機械学習は数学と統計に基づいており、数学用語で考えるのが一般的。 
元になる観測値(気温や湿度、曜日など)を"特徴量(x)"、既知の値(売れたアイスクリームの量)を"ラベル(y)"という。 y=f(x)  が成り立つ。
* 機械学習モデル: 予測するための関数をカプセル化するためのソフトウェア
* 関数を定義するプロセス: トレーニング
* 関数により新しい値を予測: 推論

## 機械学習の種類
以下の種類がある。  

![pic of Machine Learning varieties](https://learn.microsoft.com/ja-jp/training/wwl-data-ai/fundamentals-machine-learning/media/machine-learning-types.png)
## 
  
### 教師あり機械学習
トレーニングデータに"特徴量"と"ラベル"の両方が含まれる機械学習アルゴリズム。  
  
### Regression（回帰）
教師あり機械学習の一種。  
予測されるラベルは数値。例えば、特定の日に売れたアイスクリームの数、自動車の燃費など。   
トレーニングプロセスの主要は要素は以下の4つ。  
  1. トレーニングデータをランダムに分割、トレーニングの一方でトレーニング済みモデルの検証に使用するデータを確保
  2.  モデルにアルゴリズムを使用。回帰モデルの場合は、"線形回帰"など回帰アルゴリズム
  3.  検証データを使用してラベルを予測し、テストする
  4.  実際のラベルと予測したラベルを比較。予測の正確度を測る
  
#### 回帰評価メトリック
4の評価の計算方法は以下の通り。  
**平均絶対誤差(MAE)**:   
 実際と予測のラベルの差異が均等に考慮される。予測値が実際の値を上回ったか下回ったかは関係なく、誤差の数値のみを観測し、平均する。    
**平均二乗誤差(MSE)**:  
 誤差の頻度が少なくて大きいモデルよりも、一貫して小さい誤差があるほうが望ましい場合がある。個々の誤差を二乗してその平均を計算することで、誤差の値が大きい場合に増幅することができる。
 **二乗平均平方根誤差(RMSE)**:  
  前出のMSEだと誤差の個数がわからないので、平方根で計算しなおす。  
**決定係数(R<sup>2</sup>**:  
  上記のメトリックでは、実際の値と予測された値を比較している。実世界のデータではランダムな差異がある（例えば祭りのためにアイスが爆売れしたとか）が、決定係数はそれらを最小化するメトリック。ほとんどの機械学習ツールでは自動で気に計算される。1に近いほどモデルは検証データに適切に適合している。  

#### 反復トレーニング ####
現実には通常、反復プロセスを使用して、モデルのトレーニングと評価を繰り返す。  
特徴の選択と準備 / アルゴリズムの選択 / アルゴリズム パラメーター(アルゴリズムの動作を制御するための数値設定)
##

### 分類
教師あり機械学習の一種。
ラベルは分類またはクラス。  
**二項分類**: ラベルにより、2つの結果のうち一つが特定される。糖尿病のリクすありまたはなし、ローンの債務不履行または履行など。    
　回帰モデルとは違って、"確率"を計算し、予測と実際のクラスを比較する。  
  _トレーニング_ は、クラスが1または0（例えば糖尿病か否か、血糖値とのモデル）、0.5がしきい値となる。  
  _評価_ は、クラスとの比較。実際のクラスと予測クラスで、0または1の数の行列を作る。0x0または1x1の数が多ければ精度が高いモデルと言える。　　
  _正確性_ は予測が正しかった確率を指し、_リコール_ は正しく識別された陽性のケースを指す（例えば糖尿病の患者に対し予測された割合）。   
  _曲線の下の領域 (AUC)_ 上が"真陽性率(TPR)"に対して"偽陽性率(FPR)"というのがあるらしいが、よくわからない。。
  _適合率_ 実際に陽性のケースのうち要請であると予測された割合（例えば糖尿病と予測されたうち実際の患者の割合）。  
  _F1スコア_ リコールと適合率を組み合わせたメトリック。
**多クラス分類**: ラベルにより、複数の可能なクラスのうちの一つまたは複数が特定される。ペンギンの種類や、映画のジャンルなど。  
 同じ教師ありトレーニングである回帰やに二項分類と同様、反復的なトレーニング、検証、評価プロセスに従う。  
 _トレーニング_ には、One-vs-Rest (OvR) アルゴリズム（二項分類の確率を測る関数を使う。クラスが複数なので、二項分類の組み合わせを複数作る）と、多項式アルゴリズム（すべてのクラスの確率分布を含むベクター（値の配列）を使う。最も可能性の高いクラスを決定する）がある。
_評価_ は混合行列で行える。ほかの機械学習と同様に、正確性、リコール、適合率からF1スコアで行える。  

##
## 教師なし機械学習
既知のラベルがなく、特徴量のみのデータによるトレーニング。

### クラスタリング
特徴量から類似性を識別し、個別のクラスターにグループ化する。  
例えば、花弁やサイズ、葉の数に基づいて類似した花をグループ化したり、人口統計属性と購買行動に基づいて類似した顧客をグループ化する、など。  
ラベルは存在せず、特徴量の類似性からグループ化される。  



